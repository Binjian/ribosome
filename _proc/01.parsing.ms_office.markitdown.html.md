---
description: Microsoft Office document parsing with markitdown
output-file: 01.parsing.ms_office.markitdown.html
title: parsing.ms_office.markitdown

---


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Install dependencies

---

### convert_office_to_md

>      convert_office_to_md (root_folder:pathlib.Path|str,
>                            bOverwrite:bool=False, bUsePandas:bool=True,
>                            bUsePandoc:bool=False)

*Recursively convert all .pptx, .ppt, .docx, and .doc files under
root_folder (and subfolders) to PDF files in the same folder as the
original. For .xls and .xlsx files, convert to markdown (.md) files
in the same folder. Requires LibreOffice (soffice) installed for Office
document conversion. Requires pandas for Excel to markdown.*


---

### extract_base64_images

>      extract_base64_images (markdown_file_path, image_output_folder='.')

*Extracts base64 embedded images from a Markdown file, saves them to a folder,
and replaces the base64 strings with relative paths to the new image files.

Args:
    markdown_file_path (str): Path to the input Markdown file.
    image_output_folder (str): Name of the folder to save extracted images.
                               This folder will be created relative to the
                               Markdown file's directory if it doesn't exist.*


---

### extract_md_base64_images_win

>      extract_md_base64_images_win (markdown_file_path,
>                                    image_output_folder='.')

*Extracts base64 embedded images from a Markdown file, saves them to a folder,
and replaces the base64 strings with relative paths to the new image files.
This version is tailored for Windows environments, ensuring compatibility
with Windows file paths and handling of WMF/EMF images using ImageMagick 'magick' command.

Args:
    markdown_file_path (str): Path to the input Markdown file.
    image_output_folder (str): Name of the folder to save extracted images.
                               This folder will be created relative to the
                               Markdown file's directory if it doesn't exist.*


---

### extract_md_html_images_win

>      extract_md_html_images_win (markdown_file_path)

*Extracts base64 embedded images from a Markdown file, saves them to a folder,
and replaces the base64 strings with relative paths to the new image files.
This version is tailored for Windows environments, ensuring compatibility
with Windows file paths and handling of WMF/EMF images using ImageMagick 'magick' command.

Args:
    markdown_file_path (str): Path to the input Markdown file.
    image_output_folder (str): Name of the folder to save extracted images.
                            This folder will be created relative to the
                            Markdown file's directory if it doesn't exist.*


::: {#a7b1e858 .cell}
``` {.python .cell-code}
# --- How to use it ---
if False:
    # Create a dummy Markdown file for testing
    dummy_md_content = """
# My Document

This is some text.

Here is an image: ![A red dot](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==)

Some more text.

And another one: ![A blue square](data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAAFAAUDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAb/xAAgEAACAQMEAwAAAAAAAAAAAAABAgADBBESBSFBUSKR/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AIXVAvLBYy2PSkKOwz0A9YgA//Z)

This one is tricky with potential newlines in base64:
![With Newlines](data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==
)

End of document.
    """
    test_md_file = "test_document.md"
    with open(test_md_file, "w", encoding="utf-8") as f:
        f.write(dummy_md_content)
    print(f"Created dummy Markdown file: {test_md_file}")

    # Specify the path to your Markdown file
    markdown_file = test_md_file  # Or "your_actual_file.md"
    # Specify the folder (relative to the MD file) where images will be saved
    image_folder = "md_images"

    extract_base64_images(markdown_file, image_folder)

    # --- Optional: Clean up dummy files and folder after testing ---
    print("\nCleaning up dummy files...")
    if os.path.exists(os.path.join(os.path.dirname(test_md_file), image_folder)):
        for img_file in os.listdir(os.path.join(os.path.dirname(test_md_file), image_folder)):
            os.remove(os.path.join(os.path.dirname(test_md_file), image_folder, img_file))
        os.rmdir(os.path.join(os.path.dirname(test_md_file), image_folder))
    if os.path.exists(test_md_file):
        os.remove(test_md_file)
    print("Cleanup complete.")
```
:::


---

### convert_html_wmf_emf_image_from_md

>      convert_html_wmf_emf_image_from_md (root_folder)

*Recursively convert all .md files under
root_folder (and subfolders) and extract all base64 images in them into
a separate folder and replace the base64 image references in the markdown
files with the path to the extracted image.*


---

### extract_base64_from_md

>      extract_base64_from_md (root_folder)

*Recursively convert all .md files under
root_folder (and subfolders) and extract all base64 images in them into
a separate folder and replace the base64 image references in the markdown
files with the path to the extracted image.*


::: {#ed88403a .cell}
``` {.python .cell-code}
# extract_base64_from_md(r'D:/E/downloads/新型机器人智能问答系统数据源-mid/md')
```
:::


---

### copy_md_files

>      copy_md_files (src_md_root:pathlib.Path, dst_md_root:pathlib.Path,
>                     bOverwrite:bool=True)

*Recursively copy all .md files under
src_md_folder (higher quality of original office converted md by MID) (and subfolders) 
to dst_md_folder (low quality of original pdf converted md by gemini 2.5 pro exp).*


::: {#0a250b35 .cell}
``` {.python .cell-code}
if False:
    copy_md_files(Path('/v/data/新型机器人智能问答系统数据源-mid/.md.pandoc.raw.images'), Path('/v/data/新型机器人智能问答系统数据源-md/.md.pandoc.hrsl'))
```
:::


---

### convert_all_to_markdown_with_llm

>      convert_all_to_markdown_with_llm (root_folder:str|pathlib.Path,
>                                        mid:markitdown._markitdown.MarkItDown)

*Recursively convert all .pdf files under root_folder (and subfolders)
to markdown (.md) files in the same folder using marker-pdf's 'marker' command
with 4 workers.*


---

### convert_pdf_to_markdown_pdf2text

>      convert_pdf_to_markdown_pdf2text (root_folder:str|pathlib.Path)

*Recursively convert all .pdf files under root_folder (and subfolders)
to markdown (.md) files in the same folder using marker-pdf's 'marker' command
with 4 workers.*


<div>
<link rel="stylesheet" href="https://gradio.s3-us-west-2.amazonaws.com/2.6.5/static/bundle.css">
<div id="target"></div>
<script src="https://gradio.s3-us-west-2.amazonaws.com/2.6.5/static/bundle.js"></script>
<script>
launchGradioFromSpaces("abidlabs/question-answering", "#target")
</script>
</div>

