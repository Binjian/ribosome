COMMENT ::= "// " "[^\\r\\n]*" "\\r?\\n"
FLOAT ::= ([0-9])+ "." ([0-9])+
ID ::= "[a-zA-Z0-9_.]+"
INT ::= ("0" | [1-9] ([0-9])*)
NEWLINE ::= "\\r?\\n"
NOTE ::= "! " "[^\\r\\n]*" "\\r?\\n"
SPACE ::= (" " | "\t")
STRING ::= "\"" ([^"])* "\""
accAssign ::= "ACC" assignOp number
additionalInst ::= ":" SPACE (skipLaExp | outExp | "TOOL_OFFSET" (SPACE positionVar | "") | "USER_OFFSET" (SPACE positionVar | ""))
anInVar ::= "AI" "[" varIndex "]"
anOutVar ::= "AO" "[" varIndex "]"
arithOp ::= ("+" | "-" | "*" | "/")
assignOp ::= (SPACE | "") "=" (SPACE | "")
bVar ::= "B" "[" varIndex "]"
baseInst ::= (setInst | setPInst | "GETP" SPACE positionVar | setExtAxisInst | clearInst | "STRLEN" SPACE strVar SPACE iVar | "STRFIND" SPACE strVar SPACE strVar SPACE iVar | "STRSUB" SPACE strVar SPACE iVar SPACE iVar SPACE strVar | "STRCMP" SPACE strVar SPACE strVar SPACE iVar | "GETAT" SPACE strVar SPACE iVar SPACE strVar | "STRFINDEND" SPACE strVar SPACE strVar SPACE iVar | "STRREVERSE" SPACE strVar SPACE strVar | "STRSPLIT" SPACE strVar SPACE strVar SPACE INT SPACE iVar | "SPRINTF" (SPACE strVar)+ | setFrameInst | str2iInst | str2rInst | i2strInst | r2strInst)
callExp ::= "CALL" SPACE jobOrBackgroundFile
caseExp ::= "CASE" SPACE (numVar | strVar) NEWLINE (switchOpExp)* "BREAK" NEWLINE
clearInst ::= ("CLEAR" SPACE iVar SPACE iVar | "CLEAR" SPACE hVar SPACE hVar | "CLEAR" SPACE bVar SPACE bVar | "CLEAR" SPACE floatVar SPACE floatVar)
cntAssign ::= "CNT" assignOp number
conditionExp ::= (number | numVar | positionVarScalar | digitalIOVar) relationOp (number | numVar | positionVarScalar)
controlInst ::= (ifExp | whileExp | labelExp | gotoExp | delayExp | waitExp | callExp | paracallExp | "UALM" SPACE "CODE" assignOp (INT | intVar) | switchExp | forExp | "PAUSE")
copInst ::= (operateExp | "INV" SPACE positionVar | intVar assignOp "NOT" SPACE (number | numVar | positionVarScalar) | floatVar assignOp ("ATAN" | "SQRT") SPACE (number | numVar | positionVarScalar) | floatVar assignOp ("SIN" | "COS" | "TAN") SPACE (number | numVar | positionVarScalar) | floatVar assignOp "ATAN2" SPACE (number | numVar | positionVarScalar) SPACE (number | numVar | positionVarScalar) | (numVar | positionVarCoordScalar) assignOp ("MAX" | "MIN") SPACE (numVar | number | positionVarScalar) SPACE (numVar | number | positionVarScalar) | numVar assignOp ("LOG" | "POW") SPACE (numVar | number | positionVarScalar) SPACE (numVar | number | positionVarScalar) | numVar assignOp "ABS" SPACE (numVar | number | positionVarScalar))
copOpExp ::= ("(" (SPACE | "") | "") (number | numVar | positionVarCoordScalar) ((arithOp | logicOp | shiftOp) (number | numVar | positionVarCoordScalar))* ((SPACE | "") ")" | "")
crAssign ::= (cntAssign | "FINE")
delayExp ::= "DELAY" SPACE "T" assignOp (number | numVar)
diVar ::= "DI" "[" varIndex "]"
digitalIOVar ::= (diVar | giBVar | giHVar | giIVar | giFVar | doVar | goBVar | goHVar | goIVar | goFVar)
doVar ::= "DO" "[" varIndex "]"
fAssign ::= "F" assignOp (number | intVar)
floatVar ::= "R" "[" varIndex "]"
forExp ::= "FOR" SPACE intVar assignOp (intVar | number) SPACE intVar SPACE (">" | ">=" | "<" | "<=") SPACE (intVar | number) SPACE "STEP" SPACE ("-" | "") INT NEWLINE (whileOpExp)* "ENDFOR"
giBVar ::= "GIB" "[" varIndex "]"
giFVar ::= "GIF" "[" varIndex "]"
giHVar ::= "GIH" "[" varIndex "]"
giIVar ::= "GII" "[" varIndex "]"
goBVar ::= "GOB" "[" varIndex "]"
goFVar ::= "GOF" "[" varIndex "]"
goHVar ::= "GOH" "[" varIndex "]"
goIVar ::= "GOI" "[" varIndex "]"
gotoExp ::= "GOTO" SPACE STRING
hVar ::= "H" "[" varIndex "]"
i2strInst ::= "I2STR" SPACE iVar SPACE strVar
iVar ::= "I" "[" varIndex "]"
ifExp ::= ("IF" SPACE multiConExp SPACE ":" SPACE (gotoExp | callExp | outExp | delayExp | waitExp) | "IF" SPACE multiConExp NEWLINE (inst)+ ("ELSE" NEWLINE (inst)+ | "") "ENDIF" | "IF" SPACE multiConExp NEWLINE (inst)+ ("ELSEIF" SPACE multiConExp NEWLINE (inst)+)* "ENDIF")
inst ::= (opExp NEWLINE | NOTE | COMMENT)
instEnd ::= "END"
instStart ::= "NOP" NEWLINE
intVar ::= (iVar | hVar | bVar)
ioInst ::= ("IN" SPACE (iVar | floatVar) assignOp digitalIOVar | outExp | "ANIN" SPACE floatVar assignOp anInVar | "ANOUT" SPACE anOutVar assignOp (positionVarScalar | numVar | number))
irqOffExp ::= "IRQOFF" SPACE levAssign
irqOnExp ::= "IRQON" SPACE levAssign SPACE (diVar | iVar) SPACE "==" SPACE number SPACE jobOrBackgroundFile
jobOrBackgroundFile ::= ID
labelExp ::= "LABEL" SPACE STRING
levAssign ::= "LEV" assignOp INT
lhAssign ::= "LH" assignOp number
logicOp ::= ("&&" | "||" | "|" | "&" | "^")
marcoFile ::= ID
mhAssign ::= "MH" assignOp number
moveInst ::= ("MOVJ" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign (SPACE additionalInst | "") | "MOVL" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign (SPACE additionalInst | "") | "MOVC" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign ((SPACE additionalInst | SPACE ":" SPACE "SET" SPACE "TYPE" assignOp INT) | "") | "MOVS" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign | "JUMP" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign SPACE lhAssign SPACE mhAssign SPACE rhAssign | "JUMPL" SPACE positionVar SPACE velocityAssign SPACE accAssign SPACE crAssign SPACE lhAssign SPACE mhAssign SPACE rhAssign | "ARMCHANGE" SPACE ("LEFT" | "RIGHT" | "AUTO") SPACE velocityAssign)
multiConExp ::= (conditionExp (SPACE "AND" SPACE conditionExp)* | conditionExp (SPACE "OR" SPACE conditionExp)*)
numScalarOpExp ::= (numVar | positionVarCoordScalar) assignOp copOpExp
numVar ::= (intVar | floatVar)
number ::= (("-" | "") INT | ("-" | "") FLOAT)
opExp ::= (copInst | ioInst | baseInst | moveInst | operateInst | controlInst)
operateExp ::= (numScalarOpExp | positionVar assignOp positionVar (SPACE "+" SPACE positionVar)* | strVar assignOp strVar (SPACE "+" SPACE strVar)*)
operateInst ::= (irqOnExp | irqOffExp | "TIMER START" SPACE "INDEX" assignOp INT | "TIMER STOP" SPACE "INDEX" assignOp INT SPACE (iVar | floatVar) | "SKIP" SPACE "CONDITION" SPACE digitalIOVar SPACE "==" SPACE number | "USER_OFFSET_CONDITION" SPACE positionVar SPACE ufValue | "TOOL_OFFSET_CONDITION" SPACE positionVar SPACE tfValue | "RECORDMOTIONSTART" SPACE tAssign | "RECORDMOTIONSTOP" SPACE fAssign | "TCPCREATE" SPACE STRING SPACE "SERVERIP" assignOp ID SPACE "PORT" assignOp (INT | intVar) | "TCPSEND" SPACE STRING SPACE (strVar | number) | "TCPRECV" SPACE STRING SPACE (number | strVar) SPACE (number | intVar) SPACE "TIMEOUT" assignOp (number | intVar) SPACE iVar | "TCPCLOSE" SPACE STRING)
outExp ::= "OUT" SPACE (doVar | goBVar | goHVar | goIVar | goFVar) SPACE (number | numVar) (SPACE tDIS assignOp (number | intVar) | "")
paracallExp ::= ("START_BG" | "STOP_BG") SPACE jobOrBackgroundFile
posGVar ::= "PR" "[" varIndex "]"
posLVar ::= "P" "[" varIndex "]"
positionVar ::= (posGVar | posLVar)
positionVarCoordScalar ::= ("P" | "PR") "[" varIndex "]" "." ("X" | "Y" | "Z" | "RZ")
positionVarJointScalar ::= ("P" | "PR") "[" varIndex "]" "." ("J1" | "J2" | "J3" | "J4")
positionVarScalar ::= (positionVarCoordScalar | positionVarJointScalar)
prog ::= instStart (inst)* instEnd
r2strInst ::= "R2STR" SPACE floatVar SPACE strVar
relationOp ::= SPACE ("==" | "!=" | ">" | ">=" | "<" | "<=") SPACE
rhAssign ::= "RH" assignOp number
setExtAxisInst ::= "SETEXTAXIS" SPACE positionVar SPACE ID SPACE (number | numVar)
setFrameInst ::= "SETFRAME" SPACE ("TF" | "UF") SPACE (INT | intVar)
setInst ::= ("SET" SPACE positionVar SPACE positionVar | "SET" SPACE (numVar | positionVarScalar) SPACE (positionVarScalar | numVar | number) | "SET" SPACE strVar SPACE (strVar | STRING))
setPInst ::= "SETP" SPACE positionVar SPACE "FRAME" SPACE ("TF" | "UF") SPACE (number | intVar)
shiftOp ::= ("<<" | ">>")
skipLaExp ::= "SKIP" SPACE STRING
str2iInst ::= "STR2I" SPACE strVar SPACE iVar
str2rInst ::= "STR2R" SPACE strVar SPACE floatVar
strVar ::= "S" "[" varIndex "]"
switchExp ::= "SWITCH" SPACE (numVar | strVar) NEWLINE (caseExp)* "DEFAULT" NEWLINE (switchOpExp)* "BREAK" NEWLINE "ENDSWITCH"
switchOpExp ::= (inst | "BREAK" NEWLINE)
tAssign ::= "T" assignOp (number | intVar)
tDIS ::= ("T" | "DIS")
tfValue ::= "TF" "[" varIndex "]"
tnValue ::= "TN" SPACE INT
ufValue ::= "UF" "[" varIndex "]"
varIndex ::= (INT | "I" "[" INT "]")
velocityAssign ::= "V" assignOp (number | numVar)
waitExp ::= "WAIT" SPACE digitalIOVar assignOp (number | intVar) SPACE "T" assignOp (number | intVar)
whileExp ::= "WHILE" SPACE (INT | intVar | multiConExp) NEWLINE (whileOpExp)* "ENDWHILE"
whileOpExp ::= (inst | ("CONTINUE" | "BREAK") NEWLINE)
